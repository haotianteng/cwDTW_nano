#==========
# Abstract:
#==========

Title:
  Continuous Wavelet Dynamic Time Warping for unbalanced global mapping in nanopore sequencing analysis


Author:
  Renmin Han,
  Yu Li,
  Sheng Wang,
  Xin Gao


Contact email:
  realbigws@gmail.com
  xin.gao@kaust.edu.sa


#=========
# Install:
#=========

./install.sh


#=======
# Usage:
#=======

#---- type ----#
./cwDTW_nano -h


#---- usage ---#
----------- cwDTW_nano ----------
version v0.03 (OCT 22 2017)
-------------------------------------------------------------
required:
[-i DNA SEQUENCE][-p NANO SIGNAL][-o OUTPUT]
optional:
([-r RADIUS])([-l LEVEL])([-s SCALE])
-------------------------------------------------------------
**** required: ******
DNA SEQUENCE: (reference) sequence, such as ATCG...;
NANO SIGNAL:   (nanopore) raw electrical current signal;
OUTPUT:   signal alignment result; if not specified, then no output be generated;
**** key parameters: ******
RADIUS:   warp search radius (default 50);
LEVEL:    sampling level in continous wavelet (default 3);
SCALE:    base scale in continous wavelet (default sqrt(2));




#=========
# Example:
#=========

#---- align DNA sequence and nanopore raw signal ------#
./cwDTW_nano -i example/002a08b9-0248-4929-9759-2d5c0942076d.fasta -p example/002a08b9-0248-4929-9759-2d5c0942076d.rawsig -o align_out




#===============
# Output format:
#===============

e.g.,

   1     2             3         4            5                6                             7 
-----------------------------------------------------------------------------------------------------
  550   640 |          0         0 |         1.04565,        -1.17484          diff:        2.22049
  433   512 |          1         1 |       -0.560209,       -0.531815          diff:       0.028394
  411     1 |          2         2 |       -0.862165,        -1.09529          diff:        0.23312
  409     1 |          3         2 |       -0.889616,        -1.09529          diff:        0.20567
  408     1 |          4         2 |       -0.903341,        -1.09529          diff:       0.191944
  389     1 |          5         2 |        -1.16412,        -1.09529          diff:      0.0688361
  389     1 |          6         2 |        -1.16412,        -1.09529          diff:      0.0688361


[Legend]:
the 1st column is the raw signal value,
the 2nd column is the 5-mer ID 
  (see [MAP] for the mapping between 5-mer DNA and 5-mer ID),

the 3rd column shows the mapping of the first position (i.e., on raw signal) starting from 0,
the 4th column shows the mapping of the second position (i.e., on DNA sequence) starting from 0,

the 5th column indicates the Z-normalized value of raw signal,
the 6th column indicates the Z-normalized value of genome translated signal 
  (see [VAL] for the translated signal of each 5-mer),

the 7th column illustrates the absolute difference between the two Z-normalized values.


[Note]:
please find [MAP] in 'src/5mer/5mer_index_mapping'
please find [VAL] in 'src/5mer/5mer_index_table.rc'



